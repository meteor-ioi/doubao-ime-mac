# Doubao Voice Input (豆包语音输入) - 项目概况

本项目是一个基于 **Rust** 开发的轻量级、macOS 专用语音输入工具（Windows 版本已归档），通过分析豆包输入法协议实现高效、实时的语音转文本功能。

## 📍 核心功能

- 🎤 **实时流式识别**：基于豆包 ASR 引擎，支持中英文混合的高精度识别。
- ⌨️ **热键唤起**：双击 `Ctrl` 键快速启动/停止语音输入（支持自定义配置）。
- 📝 **智能文本插入**：利用 macOS 辅助功能 (Accessibility API) 直接插入焦点窗口。
- 📍 **光标随动指示器**：识别时在文本输入光标（Caret）下方显示紫色“胶囊状”指示器，实时反馈状态。
- 🔄 **增量更新优化**：引入前缀匹配算法，在识别过程中仅更变动部分，大幅减少文本闪烁。
- 🎨 **现代化 UI**：
    - **胶囊指示器**：支持原生透明度、阴影消除及呼吸缩放动效（48x36 Padding 保证识别动效完整）。
    - **系统托盘**：提供状态显示、隐藏/显示应用图标、开机自启等功能。
- 📦 **轻量极速**：单文件可执行程序 (macOS App Bundle)，极速启动。

## 🛠 技术架构

| 模块 | 技术实现 |
| :--- | :--- |
| **框架** | Tauri v2 |
| **语言** | Rust (Edition 2021) |
| **异步运行时** | Tokio |
| **音频采集** | cpal |
| **ASR 协议** | Protobuf (prost), WebSocket (tokio-tungstenite) |
| **光标追踪** | macOS Accessibility API (AXUIElement) |
| **UI 环境** | Vanilla HTML/JS, Cocoa Native API |
| **分发打包** | GitHub Actions 自动化构建，支持 macOS (.dmg) 分发 |

## 📂 目录结构简述

- `src-tauri/src/`: 核心业务逻辑，包括 ASR 协议、音频管理及 macOS 平台适配。
- `frontend/`: 基于 Vanilla Web 技术的轻量级 UI 指示器与设置页面。
- `src/asr/`: ASR 协议实现。
- `src/audio/`: 音频输入流管理。
- `src/business/`: 全局热键拦截、文本分发和增量更新算法。
- `legacy_windows/`: [已归档] Windows 版本的遗留代码、构建工具和脚本。
- `PRD/`: 详细的产品需求文档及技术说明。

## 🚀 最近主要更新

- **v1.3.0 (2026-02-12)**:
    - **架构纯化**：项目全面转型为纯 macOS 版本，移除并归档所有 Windows 相关遗留代码及工具。
    - **目录清理**：整理根目录图标资源，移除冗余脚本。
- **v1.2.0 (2026-02-11)**:
    - **架构迁移**：全面迁移至 Tauri v2 框架，并完成 macOS 深度适配。
    - **指示器进化**：升级为“紫胶囊”造型，去除阴影，解决背景不透明及动效切除问题。
    - **智能追踪**：实现指示器跟随输入光标（Caret）动态定位。
    - **稳定性增强**：修复双击 Ctrl 崩溃、指示器失踪及主线程操作冲突等核心问题。
- **v1.1.1 (2026-02-05)**:
    - 进一步清理无用代码，减小体积。
- **v1.1.0 (2026-02-05)**: 
    - **重磅更新**：实现增量更新算法，彻底解决文本闪烁。

---
*Created by Gemini for project overview.*
